{"ast":null,"code":"var _jsxFileName = \"E:\\\\Ranji\\\\bharathbank\\\\client\\\\src\\\\components\\\\login.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React, { useState } from \"react\";\nimport Card from \"./context\";\nimport firebase from 'firebase/compat/app';\nimport 'firebase/compat/auth';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst apiURL = `http://localhost:8080`;\nexport default function Login() {\n  _s();\n\n  const [show, setShow] = React.useState(true);\n  const [status, setStatus] = React.useState('');\n  return /*#__PURE__*/_jsxDEV(Card, {\n    bgcolor: \"secondary\",\n    header: \"Login\",\n    status: status,\n    body: show ? /*#__PURE__*/_jsxDEV(LoginForm, {\n      setShow: setShow,\n      setStatus: setStatus\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 17,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(LoginMsg, {\n      setShow: setShow,\n      setStatus: setStatus\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 18,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 12,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Login, \"OiPWjF7aAG19YEx9YzF5ZeGKqU4=\");\n\n_c = Login;\n\nfunction LoginMsg(props) {\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n      children: \"You Have Successfully logged in !!!\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 25,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"submit\",\n      className: \"btn btn-light\",\n      onClick: () => props.setShow(true),\n      children: \"Authenticate again\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 26,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true);\n}\n\n_c2 = LoginMsg;\n\nfunction LoginForm(props) {\n  _s2();\n\n  const [email, setEmail] = React.useState('');\n  const [password, setPassword] = React.useState('');\n\n  function handle() {\n    fetch(apiURL + `/account/login/${email}/${password}`).then(response => response.text()).then(text => {\n      try {\n        const data = JSON.parse(text);\n        props.setStatus('');\n        props.setShow(false);\n        localStorage.setItem('Name', data.name);\n        localStorage.setItem('Email', data.email);\n      } catch (err) {\n        props.setStatus(text);\n        console.log('err:', text);\n      }\n    });\n    const auth = firebase.auth();\n    const promise = auth.signInWithEmailAndPassword(email, password);\n    promise.catch(e => console.log(e.message));\n    firebase.auth().onAuthStateChanged(firebaseUser => {\n      if (firebaseUser) {\n        firebaseUser.getIdToken().then(idToken => {\n          console.log('idToken:', idToken);\n\n          (async () => {\n            let response = await fetch(apiURL + '/auth', {\n              method: 'GET',\n              headers: {\n                'Authorization': idToken\n              }\n            });\n            let text = await response.text(); // routeMsg.innerHTML = text;\n          })();\n        }).catch(e => console.log('e:', e));\n      } else {\n        console.log('User is not logged in');\n      }\n    });\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [\"Email\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 10\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"input\",\n      className: \"form-control\",\n      placeholder: \"Enter email\",\n      value: email,\n      onChange: e => setEmail(e.currentTarget.value)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 56\n    }, this), \"Password\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"password\",\n      className: \"form-control\",\n      placeholder: \"Enter password\",\n      value: password,\n      onChange: e => setPassword(e.currentTarget.value)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 59\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      id: \"login\",\n      type: \"submit\",\n      className: \"btn btn-light\",\n      disabled: !email || !password,\n      onClick: handle,\n      children: \"Login\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true);\n}\n\n_s2(LoginForm, \"TSZhDBNy8CmbxXgprY/vvMmTG1Q=\");\n\n_c3 = LoginForm;\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"Login\");\n$RefreshReg$(_c2, \"LoginMsg\");\n$RefreshReg$(_c3, \"LoginForm\");","map":{"version":3,"sources":["E:/Ranji/bharathbank/client/src/components/login.js"],"names":["React","useState","Card","firebase","apiURL","Login","show","setShow","status","setStatus","LoginMsg","props","LoginForm","email","setEmail","password","setPassword","handle","fetch","then","response","text","data","JSON","parse","localStorage","setItem","name","err","console","log","auth","promise","signInWithEmailAndPassword","catch","e","message","onAuthStateChanged","firebaseUser","getIdToken","idToken","method","headers","currentTarget","value"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\r\nimport Card from \"./context\";\r\nimport firebase from 'firebase/compat/app';\r\nimport 'firebase/compat/auth';\r\n\r\nconst apiURL = `http://localhost:8080`;\r\n\r\nexport default function Login(){\r\n  const [show, setShow]     = React.useState(true);\r\n  const [status, setStatus] = React.useState('');  \r\n  return (\r\n    <Card\r\n      bgcolor=\"secondary\"\r\n      header=\"Login\"\r\n      status={status}\r\n      body={show ? \r\n        <LoginForm setShow={setShow} setStatus={setStatus}/> :\r\n        <LoginMsg setShow={setShow} setStatus={setStatus}/>}\r\n    />\r\n  ) \r\n}\r\n\r\nfunction LoginMsg(props){  \r\n  return(<>\r\n    <h5>You Have Successfully logged in !!!</h5>\r\n    <button type=\"submit\" \r\n      className=\"btn btn-light\" \r\n      onClick={() => props.setShow(true)}>\r\n        Authenticate again\r\n    </button>\r\n  </>);\r\n}\r\n\r\nfunction LoginForm(props){\r\n  const [email, setEmail]       = React.useState('');\r\n  const [password, setPassword] = React.useState('');\r\n  \r\n  \r\n  function handle(){\r\n    fetch(apiURL+ `/account/login/${email}/${password}`)\r\n    .then(response => response.text())\r\n    .then(text => {\r\n        try {\r\n            const data = JSON.parse(text);\r\n            props.setStatus('');\r\n            props.setShow(false);\r\n                        \r\n            localStorage.setItem('Name',data.name);  \r\n            localStorage.setItem('Email',data.email);            \r\n        } catch(err) {\r\n            props.setStatus(text)\r\n            console.log('err:', text);\r\n        }\r\n    }); \r\n      const auth  = firebase.auth();  \r\n      \r\n      const promise = auth.signInWithEmailAndPassword(email, password);\r\n      promise.catch(e => console.log(e.message));\r\n      firebase.auth().onAuthStateChanged(firebaseUser => {\r\n        if(firebaseUser){\r\n          firebaseUser.getIdToken().then(idToken => {\r\n            console.log('idToken:', idToken);\r\n            (async () => {\r\n              let response = await fetch(apiURL+'/auth', {\r\n                  method: 'GET',\r\n                  headers: {\r\n                      'Authorization': idToken\r\n                  }\r\n              });\r\n              let text = await response.text();\r\n              // routeMsg.innerHTML = text;\r\n          })();\r\n         }).catch(e => console.log('e:',e));\r\n                \r\n        }\r\n        else{\r\n            console.log('User is not logged in');          \r\n        }\r\n    });\r\n    \r\n  \r\n  }\r\n  return (<>\r\n    Email<br/>\r\n    <input type=\"input\" \r\n      className=\"form-control\" \r\n      placeholder=\"Enter email\" \r\n      value={email} \r\n      onChange={e => setEmail(e.currentTarget.value)}/><br/>\r\n\r\n    Password<br/>\r\n    <input type=\"password\" \r\n      className=\"form-control\" \r\n      placeholder=\"Enter password\" \r\n      value={password} \r\n      onChange={e => setPassword(e.currentTarget.value)}/><br/>\r\n    <button id=\"login\" type=\"submit\" className=\"btn btn-light\" disabled={!email || !password}onClick={handle}>Login</button>  \r\n  </>);\r\n}"]},"metadata":{},"sourceType":"module"}